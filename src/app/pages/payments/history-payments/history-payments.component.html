<div class="container mx-auto p-6">
    <div mat-dialog-title>
        <h1 class="text-3xl font-semibold mb-6 text-black">HISTORIAL DE ABONOS</h1>
    </div>
    <mat-dialog-content >
      <div id="history-content">
        <!-- Información del cliente -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="text-black grid grid-cols-2 gap-y-2">
                <!-- Cliente -->
                <p class="font-semibold">Cliente:</p>
                <p class="font-normal">
                  {{ infoCredito.client.first_name?.toUpperCase() }} {{ infoCredito.client.last_name?.toUpperCase() }}
                </p>
                <!-- Identificación -->
                <p class="font-semibold">Identificación:</p>
                <p class="font-normal">
                  {{ infoCredito.client.document_number }}
                </p>
              
                <!-- Fecha inicio crédito -->
                <p class="font-semibold">Fecha inicio crédito:</p>
                <p class="font-normal">
                  {{ infoCredito.loan_date | date: 'dd/MM/yyyy' }}
                </p>
              
                <!-- Monto de crédito -->
                <p class="font-semibold">Monto de crédito:</p>
                <p class="font-normal">
                  {{ infoCredito.loan_amount | currency: 'COP' }}
                </p>
              
                <!-- Tasa de interés corriente -->
                <p class="font-semibold">Tasa de interés corriente:</p>
                <p class="font-normal">
                  {{ infoCredito.interest_rate }}% mensual
                </p>
              
                <!-- Tasa de interés moratorio -->
                <p class="font-semibold">Tasa de interés moratorio:</p>
                <p class="font-normal">
                  3.10 mensual
                </p>
              
                <!-- Fecha de emisión del reporte -->
                <p class="font-semibold">Fecha de emisión del reporte:</p>
                <p class="font-normal">
                  {{ currentDate | date: 'dd/MM/yyyy' }}
                </p>
              </div>
              
            <div>
                <div class="flex justify-end gap-4">

                    <button 
                      mat-raised-button color="primary" 
                      class="bg-primary flex items-center space-x-2" 
                      (click)="createAbono()"
                    >
                      <mat-icon>add_circle_outline</mat-icon>
                      <span>Registrar Abono</span>
                    </button>
                    <button mat-raised-button color="primary" class="bg-primary flex items-center space-x-2" (click)="generatePDF()">
                        <mat-icon>print</mat-icon>
                        <span>Imprimir Kardex</span>
                    </button>
                </div>
            </div>
        </div>



        <h2 class="text-2xl font-semibold mb-4 text-gray-950">Estado actual del crédito:</h2>
        <!-- Tabla con Material Design -->
        <div class="overflow-x-auto ">
            <table mat-table [dataSource]="conceptsCredit" class="w-full border-collapse mb-4">
                <!-- Concepto Column -->
                <ng-container matColumnDef="concept">
                    <th mat-header-cell *matHeaderCellDef
                        class="bg-primary text-white px-6 py-3 text-center rounded-tl-lg text-center">
                        Concepto</th>
                    <td mat-cell *matCellDef="let element"
                        class="px-6 py-4 border-b border-gray-200 text-gray-700 text-center">{{
                        element.concept }}</td>
                </ng-container>

                <!-- Monto Column -->
                <ng-container matColumnDef="amount">
                    <th mat-header-cell *matHeaderCellDef
                        class="bg-primary text-white px-6 py-3 text-center rounded-tr-lg text-center">
                        Monto</th>
                    <td mat-cell *matCellDef="let element"
                        class="px-6 py-4 border-b border-gray-200  text-gray-700 text-center">{{ element.amount |
                        currency:'':'symbol':'1.2-2' }}</td>
                </ng-container>

                <!-- Header and Row Declarations -->
                <tr mat-header-row *matHeaderRowDef="displayedColumnsStateCredit"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsStateCredit;"></tr>
            </table>
            <br>
        </div>



        <div class="container mx-auto p-6">
            <h2 class="text-2xl font-semibold text-gray-950 mb-4">Historial de movimientos (mensual):</h2>
            <!-- Tabla con Material Design y Tailwind -->
            <div class="overflow-x-auto">
                <table mat-table [dataSource]="historyPayments" class="w-full border-collapse bg-white">
      
                    <!-- Fecha del abono Column -->
                    <ng-container matColumnDef="paymentDate">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Fecha del abono</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200">{{ element.paymentDate | date: 'dd/MM/yyyy' }}</td>
                    </ng-container>
              
                    <!-- Interés Corriente Column -->
                    <ng-container matColumnDef="currentInterest">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Interés Corriente</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.currentInterest || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Abono a Capital Column -->
                    <ng-container matColumnDef="capitalPayment">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Abono a Capital</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.capitalPayment || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Abono a Interés Column -->
                    <ng-container matColumnDef="interestPayment">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Abono a Interés</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.interestPayment || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Interés Moratorio Column -->
                    <ng-container matColumnDef="lateInterest">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Interés Moratorio</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.lateInterest || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Pago Total Column -->
                    <ng-container matColumnDef="amount">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Pago Total</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.amount || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Capital Actual Column -->
                    <ng-container matColumnDef="currentCapital">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left">Capital Actual</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.currentCapital || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Capital Pendiente Column -->
                    <ng-container matColumnDef="pendingCapital">
                      <th mat-header-cell *matHeaderCellDef class="bg-primary text-white px-4 py-3 text-left rounded-tr-lg">Capital pendiente</th>
                      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b border-gray-200 text-right">{{ element.remainingCapital || 0 | currency: '' }}</td>
                    </ng-container>
              
                    <!-- Header and Row Declarations -->
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  </table>
            </div>
        </div>
      </div>
    </mat-dialog-content>


    <mat-dialog-actions align="center" class="p-4">
        <button mat-raised-button mat-dialog-close color="primary">Cerrar</button>
    </mat-dialog-actions>
</div>