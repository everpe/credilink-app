<div class="container">
  <h2 class="text-xl font-medium text-black text-center mb-4">Actualizar contraseña</h2>
  <form [formGroup]="changePasswordForm">
    <!-- Contraseña Actual -->
    <div class="mb-4">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Contraseña Actual</mat-label>
        <input matInput formControlName="current_password" [type]="hideCurrent ? 'password' : 'text'" />
        <button mat-icon-button matSuffix (click)="hideCurrent = !hideCurrent"
          [attr.aria-label]="'Mostrar contraseña actual'">
          <mat-icon>{{ hideCurrent ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </mat-form-field>
      @if (f['current_password'].invalid && (f['current_password'].dirty || f['current_password'].touched)) {
      @if (f['current_password'].errors?.['required']) {
      <mat-error>La contraseña actual es requerida.</mat-error>
      }
      }
    </div>

    <!-- Nueva Contraseña -->
    <div class="mb-4">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Nueva Contraseña</mat-label>
        <input matInput formControlName="password" [type]="hidePassword ? 'password' : 'text'" />
        <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword"
          [attr.aria-label]="'Mostrar nueva contraseña'">
          <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </mat-form-field>
      @if (f['password'].invalid && (f['password'].dirty || f['password'].touched)) {
      @if (f['password'].errors?.['required']) {
      <mat-error>La nueva contraseña es requerida.</mat-error>
      }
      @if (f['password'].errors?.['minlength']) {
      <mat-error>Mínimo 6 caracteres.</mat-error>
      }
      }
    </div>

    <!-- Confirmar Contraseña -->
    <div class="mb-4">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Confirmar Nueva Contraseña</mat-label>
        <input matInput formControlName="password_confirm" [type]="hideConfirm ? 'password' : 'text'" />
        <button mat-icon-button matSuffix (click)="hideConfirm = !hideConfirm"
          [attr.aria-label]="'Mostrar confirmar contraseña'">
          <mat-icon>{{ hideConfirm ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </mat-form-field>
      @if (f['password_confirm'].invalid && (f['password_confirm'].dirty || f['password_confirm'].touched)) {
      @if (f['password_confirm'].errors?.['required']) {
      <mat-error>La confirmación de contraseña es requerida.</mat-error>
      }
      @if (f['password_confirm'].errors?.['minlength']) {
      <mat-error>Mínimo 6 caracteres.</mat-error>
      }
      }
    </div>

    <!-- Botón de envío -->
    <div class="flex justify-center">
      <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="isSubmitting">
        Actualizar Contraseña
      </button>
      @if (isSubmitting) {
      <mat-spinner diameter="24"></mat-spinner>
      }
    </div>
  </form>
</div>